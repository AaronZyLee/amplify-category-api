batch:
  fast-fail: false
  build-graph:
    - identifier: publish_cli_to_local_registry
      buildspec: codebuild_specs/publish-cli-to-local-registry.yml
      env:
        variables:
          BUILD_ID: publish_cli_to_local_registry
      ignore-failure: false
    - identifier: custom_transformers_l
      buildspec: codebuild_specs/amplify-e2e-tests.yml
      env:
        variables:
          BUILD_ID: custom_transformers_l
          TEST_SUITE: custom-transformers.test.ts
          CLI_REGION: us-west-2
          USE_PARENT_ACCOUNT: true
      depend-on:
        - publish_cli_to_local_registry
    - identifier: function_10_l
      buildspec: codebuild_specs/amplify-e2e-tests.yml
      env:
        variables:
          BUILD_ID: function_10_l
          TEST_SUITE: function_10.test.ts
          CLI_REGION: us-west-1
          USE_PARENT_ACCOUNT: true
      depend-on:
        - publish_cli_to_local_registry
    - identifier: mock_api_l
      buildspec: codebuild_specs/amplify-e2e-tests.yml
      env:
        variables:
          BUILD_ID: mock_api_l
          TEST_SUITE: mock-api.test.ts
          CLI_REGION: us-east-1
          USE_PARENT_ACCOUNT: true
      depend-on:
        - publish_cli_to_local_registry